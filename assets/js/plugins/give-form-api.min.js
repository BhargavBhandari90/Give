!function(e){var t,i;e.fn.give_reveal_form=function(){return this.each(function(){var t=e(this),i=e(".give-btn-reveal",t);i.on("click",function(t){t.preventDefault(),e(this).trigger("give_reveal_form_button_click"),e(this).prev("form").slideDown(),e(this).show()})})},e.fn.give_modal_form=function(){return this.each(function(){var t=e(this),i=e(".give-btn-modal",t);i.magnificPopup({items:{src:e("form",t),type:"inline"},callbacks:{beforeOpen:function(){i.trigger("give_modal_form_button_click"),i.hide()},open:function(){i.trigger("give_modal_form_popup_open")},close:function(){i.trigger("give_modal_form_popup_close"),e(".give-show-without-modal",t).length&&e("form",t).removeClass("mfp-hide"),i.show()}}})})},e.fn.give_button_form=function(){return this.each(function(){var t=e(this),i=e(".give-btn-button",t);i.magnificPopup({items:{src:e("form",t),type:"inline"},callbacks:{beforeOpen:function(){i.trigger("give_button_form_button_click"),i.hide()},open:function(){i.trigger("give_button_form_popup_open")},close:function(){i.trigger("give_button_form_popup_close"),i.show()}}})})},e.fn.give_stepper_form=function(){return this.each(function(){var t=e(this),i=e(".give-block-wrapper",t),r=e('input[name="next"]',t),a=e('input[name="prev"]',t),n=100/(parseInt(i.length)-1),o=500;return i.length?(i.each(function(t,i){e(i).attr("data-step",t)}),e(".give-block-wrapper:first-child",t).addClass("give-active"),t.css({paddingBottom:e(".give-block-wrapper.give-active",t).height()+"px"}),void t.on("click",'input[name="prev"], input[name="next"]',function(){var i=e(".give-block-wrapper.give-active",t),r=e(this).attr("name"),a="next"===r,l=a?i.next(".give-block-wrapper"):i.prev(".give-block-wrapper"),s=parseInt(n)*parseInt(l.attr("data-step")),c=a?"-":"",d=a?"":"-";e("html, body").animate({scrollTop:t.offset().top},"fast"),t.css({paddingBottom:l.height()+"px"}),e(".current_steps",t).animate({width:s+"%"},o,function(){}),i.animate({left:c+"100%"},o).removeClass("give-active"),l.css({left:d+"100%"}).animate({left:"0%"},o).addClass("give-active")})):(r.remove(),a.remove(),!1)})},e.fn.give_colorpicker_fields=function(){return this.each(function(){var t=e(this);t.parents(".wp-picker-container").length||t.parents(".give-template").length||t.wpColorPicker()})},e.fn.give_media_fields=function(){return this.each(function(){e(this).on("click",function(r){return r.preventDefault(),i=e(this),t?void t.open():(t=wp.media.frames.file_frame=wp.media({title:give_form_api_var.metabox_fields.media.button_title,frame:"post",button:{text:give_form_api_var.metabox_fields.media.button_title},multiple:!1}),t.on("insert",function(){var r=t.state().get("selection").first().toJSON(),a=i.prev(),n=e(".attachment-display-settings .size").val(),o="id"===a.data("fvalue")?r.id:r.sizes[n].url;a.val(o)}),t.on("open",function(){e("a.media-menu-item").each(function(){switch(e(this).text().trim()){case"Create Gallery":case"Insert from URL":e(this).hide()}})}),e("body").on("click",".thumbnail",function(t){var i=e(".attachment-display-settings");i.length&&(e(".alignment",i).closest("label").hide(),e(".link-to",i).closest("label").hide(),e(".attachment-details label").hide())}),t.open(),!1)})})};var r={init:function(){this.setup_repeatable_fields(),this.handle_repeater_group_events(),this.handle_multi_levels_repeater_group_events()},setup_repeatable_fields:function(){jQuery(function(){jQuery(".give-repeatable-field-section").each(function(){var t=e(this),i={wrapper:".give-repeatable-fields-section-wrapper",container:".container",row:".give-row",add:".give-add-repeater-field-section-row",remove:".give-remove",move:".give-move",template:".give-template",confirm_before_remove_row:!0,confirm_before_remove_row_text:give_form_api_var.confirm_before_remove_row_text,is_sortable:!0,before_add:null,after_add:a,before_remove:null,after_remove:n,sortable_options:{placeholder:"give-ui-placeholder-state-highlight",start:function(t,i){e("body").trigger("repeater_field_sorting_start",[i.item])},stop:function(t,i){e("body").trigger("repeater_field_sorting_stop",[i.item])},update:function(i,r){r.item.next().hasClass("give-template")&&r.item.next().after(r.item);var a=e(".give-row",t).not(".give-template");if(a.length){var n=1;a.each(function(t,i){var r=e(".give-field, label",e(i));r.length&&r.each(function(){var t=e(this).parents(".give-field-wrap"),i=e(this);e.each(this.attributes,function(e,r){var a=this.value.replace(/\[/g,"_").replace(/]/g,""),o=a+"_field",l="",s="";this.value&&(this.value=this.value.replace(/\[\d+\]/g,"["+(n-1)+"]"),s=this.value.replace(/\[/g,"_").replace(/]/g,""),t.hasClass(o)&&(l=s+"_field",t.removeClass(o).addClass(l)),a==i.attr("id")&&i.attr("id",s))})}),n++}),t.trigger("repeater_field_row_reordered",[r.item])}}}};jQuery(this).repeatable_fields(i)})})},handle_repeater_group_events:function(){var t=e(".give-repeatable-field-section"),i=e("body");i.on("click",".give-row-head button",function(){var t=e(this).closest("tr");t.toggleClass("closed"),e(".give-row-body",t).toggle()}),t.on("repeater_field_new_row_added repeater_field_row_deleted repeater_field_row_reordered",function(){o(e(this))}),i.on("repeater_field_sorting_start",function(t,i){var r=e(".wp-editor-area",i);r.length&&r.each(function(t,i){window.setTimeout(function(){tinyMCE.execCommand("mceRemoveEditor",!0,e(i).attr("id"))},300)})}),i.on("repeater_field_sorting_stop",function(t,i){var r=e(".wp-editor-area",i);r.length&&r.each(function(t,i){window.setTimeout(function(){var t=e(i).attr("id");tinyMCE.execCommand("mceAddEditor",!0,t),window.setTimeout(function(){switchEditors.go(t,"html"),e("#"+t+"-tmce").trigger("click")},100)},300)})}),t.each(function(t,i){var r=e(i);o(r),parseInt(r.data("close-tabs"))&&(e(".give-row-head button",r).trigger("click"),e(".give-template",r).removeClass("closed"),e(".give-template .give-row-body",r).show())}),t.on("repeater_field_new_row_added",function(t,i,r){e(".give-colorpicker",e(this)).give_colorpicker_fields();var a=e("div[data-wp-editor]",r);a.length&&a.each(function(t,i){var r=e(i),a=e(".wp-editor-wrap",r),n=e("textarea",r),o="give_wysiwyg_unique_"+Math.random().toString().replace(".","_"),l=a.prev();n.attr("id",o),e.post(ajaxurl,{action:"give_load_wp_editor",wp_editor:r.data("wp-editor"),wp_editor_id:o,textarea_name:e("textarea",r).attr("name")},function(t){a.remove(),l.after(t),tinyMCEPreInit.qtInit[n.attr("id")]=e.extend(!0,tinyMCEPreInit.qtInit._give_agree_text,{id:o}),tinyMCEPreInit.mceInit[o]=e.extend(!0,tinyMCEPreInit.mceInit._give_agree_text,{body_class:o+" post-type-give_forms post-status-publish locale-"+tinyMCEPreInit.mceInit._give_agree_text.wp_lang_attr.toLowerCase(),selector:"#"+o}),tinymce.init(tinyMCEPreInit.mceInit[o]),quicktags(tinyMCEPreInit.qtInit[o]),QTags._buttonsInit(),window.setTimeout(function(){switchEditors.go(o,"html"),e("#"+o+"-tmce").trigger("click")},100),window.wpActiveEditor||(window.wpActiveEditor=o)})})})},handle_multi_levels_repeater_group_events:function(){var t=e("#_give_donation_levels_field");e("body").on("keyup",".give-multilevel-text-field",function(){var t=e(this).closest("tr"),i=e(".give-row-head h2 span",t),r=i.data("header-title");return(!e(this).val()||e(this).val()!==i.html())&&void(e(this).val()?i.html(r+": "+e(this).val()):i.html(r))}),e(".give-multilevel-text-field").each(function(t,i){if(t){var r=e(i),a=r.closest("tr"),n=e(".give-row-head h2 span",a),o=n.data("header-title");return(!r.val()||r.val()!==n.html())&&void(r.val()?n.html(o+": "+r.val()):n.html(o))}}),t.on("repeater_field_row_deleted",function(){var t=e(this);window.setTimeout(function(){var i=t,r=e(".give-row",i).not(".give-template"),a=e(".give-give_default_radio_inline",r),n=r.length;1===n&&a.prop("checked",!0)},200)}),t.on("repeater_field_new_row_added",function(t,i,r){var a=e(this),n=0;window.setTimeout(function(){e(".give-give_default_radio_inline",a).is(":checked")===!1&&e(".give-row",a).not(".give-template").first().find(".give-give_default_radio_inline").prop("checked",!0)},200),e('input[type="hidden"].give-levels_id',a).each(function(t,i){var r=e(i);n<r.val()&&(n=r.val())}),e('input[type="hidden"].give-levels_id',r).val(++n)})}},a=function(t,i){var r=e(t).attr("data-rf-row-count"),a=e(t),n=a.parents(".give-repeatable-field-section");r++,e("*",i).each(function(){e.each(this.attributes,function(e,t){this.value=this.value.replace("{{row-count-placeholder}}",r-1)})}),e(t).attr("data-rf-row-count",r),n.trigger("repeater_field_new_row_added",[t,i])},n=function(t){var i=e(t),r=i.parents(".give-repeatable-field-section"),a=e(t).attr("data-rf-row-count");i.attr("data-rf-row-count",--a),r.trigger("repeater_field_row_deleted")},o=function(t){if(parseInt(t.data("group-numbering"))){var i=e(".give-row-head h2 span",t),r=i.data("header-title");i.each(function(t,i){var a=e(i);a.parents(".give-template").length||a.html(r+": "+t)})}};e(document).ready(function(){var t=e(".give-display-style-reveal"),i=e(".give-display-style-modal"),a=e(".give-display-style-button"),n=e(".give-display-style-stepper"),o=e(".give-media-upload"),l=e(".give-colorpicker");t.length&&t.give_reveal_form(),i.length&&i.give_modal_form(),a.length&&a.give_modal_form(),n.length&&n.give_stepper_form(),l.length&&l.give_colorpicker_fields(),o.length&&o.give_media_fields(),e(".give-repeater-field-wrap").length&&r.init()})}(jQuery);